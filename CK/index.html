<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>åƒä¸‡åˆ«èµ°åˆ°ç»ˆç‚¹ï¼</title>
<style>
    body {
        background:#000;
        color:white;
        text-align:center;
        font-family:Arial;
        padding-top:40px;
    }

    h4{
        cursor:pointer;
        font-size:28px;
        display:inline-block;
        padding:10px 20px;
        border:2px solid white;
        border-radius:10px;
        transition:.2s;
    }
    h4:hover{
        color:red;
        border-color:red;
    }

    .board{
        width:600px;
        margin:40px auto;
        display:flex;
        justify-content:space-between;
    }
    .cell{
        width:80px;
        height:80px;
        background:linear-gradient(to right,#bbb,#446);
        border-radius:8px;
    }

    #player{
        width:70px;
        height:70px;
        position:absolute;
        top:350px;
        left:420px;
        transition:left .35s ease;
    }

    /* ææ€–å›¾ */
    #scare{
        display:none;
        position:fixed;
        left:0;top:0;
        width:100%;
        height:100%;
        object-fit:cover;
        z-index:999;
        animation:fadeIn .4s forwards;
    }
    @keyframes fadeIn{
        from{ opacity:0; }
        to{ opacity:1; }
    }
</style>
</head>

<body>
    <h4 id="rollBtn">æ·éª°å­ ğŸ²</h4>

    <p id="msg">ä½ éšæœºé€‰ä¸­çš„æ•°å­—æ˜¯ï¼šï¼Ÿ</p>

    <div class="board">
        <div class="cell"></div><div class="cell"></div><div class="cell"></div>
        <div class="cell"></div><div class="cell"></div><div class="cell"></div>
    </div>

    <img id="player" src="./img/ç«ç¥.png">
    <audio id="sound" src="bird.wav"></audio>

    <img id="scare" src="./img/ææ€–.png" />

<script>
const rollBtn = document.getElementById("rollBtn");
const msg = document.getElementById("msg");
const player = document.getElementById("player");
const cells = document.getElementsByClassName("cell");
const scare = document.getElementById("scare");
const sound = document.getElementById("sound");

let currentPos = 0;    // å½“å‰è½åœ¨ç¬¬å‡ æ ¼
let locked = false;    // é˜²æ­¢é‡å¤ç‚¹å‡»

rollBtn.onclick = function(){
    if(locked) return;   // é˜²æ­¢å¤šæ¬¡ç‚¹å‡»
    locked = true;

    let num = Math.floor(Math.random()*10);
    msg.innerHTML = `ä½ éšæœºé€‰ä¸­çš„æ•°å­—æ˜¯ï¼š${num}`;

    // 50% è§¦å‘ææ€–ï¼ˆå’ŒåŸç‰ˆä¸€æ ·ï¼‰
    if(num >= 5) num = 5;

    let target = Math.min(currentPos + num, 5);  
    moveToCell(target, num);
};


function moveToCell(target, rolledNum){
    let i = currentPos;

    function step(){
        if(i > target){
            // åˆ°è¾¾æœ€ç»ˆç‚¹
            currentPos = target;
            checkScare(rolledNum);
            locked = false;
            return;
        }

        let x = cells[i].offsetLeft;
        player.style.left = (x + 10) + "px";  // +10 å¾®è°ƒä½ç½®
        i++;

        setTimeout(step, 350);  // æ­¥è¿›åŠ¨ç”»
    }

    step();
}


// å¦‚æœèµ°åˆ°ç¬¬6æ ¼ï¼ˆ= æ•°å­— >=5ï¼‰â€”â€”è§¦å‘ææ€–
function checkScare(rolledNum){
    if(rolledNum == 5){
        scare.style.display = "block";
        sound.play();

        setTimeout(()=>{
            scare.style.display = "none";
            location.reload();   // é‡æ–°å¼€å§‹
        },2500);
    }
}
</script>

</body>
</html>
